<!DOCTYPE html>
<!--suppress HtmlFormInputWithoutLabel -->
<html lang="ko" xmlns:th="http://www.thymeleaf.org" th:lang="${#locale.language}" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title th:text="#{entity.categories}"></title>

    <!-- CSS -->
    <link rel="stylesheet" th:href="@{/css/bootstrap.css}">
    <link rel="stylesheet" th:href="@{/css/global.css}">
    <link rel="stylesheet" th:href="@{/css/grid.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/tui-tree/dist/tui-tree.css}">

    <script src="https://kit.fontawesome.com/017bbb35cd.js" crossorigin="anonymous"></script>

    <!-- JS -->
    <script th:src="@{/js/bootstrap.js}"></script>
    <script th:src="@{/tui-tree/dist/tui-tree.js}"></script>

    <style>
        header, aside, main, footer {
            border: 1px dashed red;
            box-sizing: border-box;
        }
    </style>

    <script th:if="${message}" th:inline="javascript">
        alert([[${message}]]);
    </script>

</head>

<body>

    <header th:replace="~{header :: header}"></header>

    <div class="d-flex">

        <aside th:replace="~{aside :: aside}"></aside>

        <main class="flex-grow-1 p-3">

            <div class="d-flex justify-content-end p-3 mb-3 rounded">
                <a class="btn btn-primary mx-2" th:href="@{/categories/new}" th:text="#{label.create}"></a>
            </div>

            <!--/*
            <div id="tree" class="tui-tree-wrap"></div>
            */-->

            <div th:fragment="tree(categories)">
                <ul class="list-group">
                    <li class="list-group-item" th:each="category : ${categories}">
                        <a th:href="@{/articles/list(categoryId=${category.id})}" th:text="${category.name}"></a>
                        <a th:href="@{'/categories/' + ${category.id} + '/edit'}" class="btn"><span class="fa fa-pencil"></span></a>
                        <div th:if="${!#lists.isEmpty(category.children)}" th:replace=":: tree(${category.children})"></div>
                    </li>
                </ul>
            </div>

        </main>

    </div>

    <footer th:replace="~{footer :: footer}"></footer>

<!--/*
        <script>

            document.addEventListener('DOMContentLoaded', () => {

                const container = document.getElementById('tree');
                const data = [
                    {
                        pid: '001',
                        text: 'rootA',
                        children: [
                            {
                                pid: '003',
                                text: 'root-1A',
                                state: 'closed'
                            }
                        ]
                    },
                    {
                        pid: '002',
                        text: 'rootB',
                        state: 'opened'
                    }
                ];
                const options = {
                    data: data,
                    nodeIdPrefix: 'tui-tree-node-',
                    nodeDefaultState: 'closed',
                    stateLabels: {
                        opened: '-',
                        closed: '+'
                    },
                    template: {
                        internalNode:
                            '<div class="tui-tree-btn">' +
                            '<button type="button" class="tui-tree-toggle-btn tui-js-tree-toggle-btn">' +
                            '<span class="tui-ico-tree"></span>' +
                            '{{stateLabel}}' +
                            '</button>' +
                            '<span class="tui-tree-text tui-js-tree-text">' +
                            '<span class="tui-tree-ico tui-ico-folder"></span>' +
                            '{{text}}' +
                            '</span>' +
                            '</div>' +
                            '<ul class="tui-tree-subtree tui-js-tree-subtree">{{children}}</ul>',
                        leafNode:
                            '<div class="tui-tree-btn">' +
                            '<span class="tui-tree-text tui-js-tree-text">' +
                            '<span class="tui-tree-ico tui-ico-file"></span>' +
                            '{{text}}' +
                            '</span>' +
                            '</div>'
                    },
                    // renderTemplate: (tmpl, props) => Mustache.render(tmpl, props) // Mustache template engine
                };
                const tree = new tui.Tree(container, options);

            });
        </script>
*/-->
    </body>
</html>